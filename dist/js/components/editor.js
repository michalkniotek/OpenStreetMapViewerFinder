'use strict';

Object.defineProperty(exports, "__esModule", {
  value: true
});
// Generated by CoffeeScript 1.10.0
require('../common/common');
var React = require('react');
var $ = require('jquery');
var viewerComponent = require('./viewer').default;

var defaultCoordinates, mapowanieKoordynat, step;
step = 0.002;
mapowanieKoordynat = {
  x1: 'X1 - longitude west',
  x2: 'X2 - longitude east',
  x3: 'X3 - longitude marker',
  y1: 'Y1 - latitude south',
  y2: 'Y2 - latitude north',
  y3: 'Y3 - latitude marker'
};
defaultCoordinates = {
  x1: 0.0,
  x2: 0.0,
  x3: 0.0,
  y1: 0.0,
  y2: 0.0,
  y3: 0.0
};

exports.default = React.createClass({
  displayName: 'openStreetMapEditor',
  getDefaultProps: function getDefaultProps() {
    return {
      coordinates: defaultCoordinates,
      size: {
        width: 425,
        height: 350
      },
      address: ''
    };
  },
  getInitialState: function getInitialState() {
    return {
      address: this.props.address,
      coordinates: this.props.coordinates,
      searchResults: null,
      viewCoordinates: this.props.coordinates,
      texts: {
        brakWynikowWyszukiwania: "No results",
        bladOdpowiedziNominatim: "No response from Nominatim server",
        wyczyscCoordynaty: "Clear coordinates",
        szukaj: "Search"
      }
    };
  },
  getResultsByAddress: function getResultsByAddress() {
    return $.ajax({
      url: 'https://nominatim.openstreetmap.org/search.php',
      dataType: 'json',
      data: {
        q: this.state.address,
        format: 'json'
      },
      timeout: 5000,
      success: (function (_this) {
        return function (data) {
          if (data.length) {
            return _this.setState({
              searchResults: data.map(function (obj) {
                return {
                  displayName: obj.display_name,
                  coordinates: {
                    x1: obj.boundingbox[2],
                    x2: obj.boundingbox[3],
                    x3: obj.lon,
                    y1: obj.boundingbox[0],
                    y2: obj.boundingbox[1],
                    y3: obj.lat
                  }
                };
              })
            });
          } else {
            _this.setState({
              searchResults: []
            });
            return alert(_this.state.texts.brakWynikowWyszukiwania);
          }
        };
      })(this),
      error: (function (_this) {
        return function () {
          _this.setState({
            searchResults: []
          });
          return alert(_this.state.texts.bladOdpowiedziNominatim);
        };
      })(this)
    });
  },
  updateViewCoords: (function (newCoordinates) {
    return this.setState({
      viewCoordinates: newCoordinates
    });
  }).slowly(500),
  updateCoordinate: function updateCoordinate(name, value) {
    var coordinates, newCoordinates;
    coordinates = this.state.coordinates;
    newCoordinates = Object.clone(coordinates);
    newCoordinates[name] = value;
    return this.updateCoordinates(newCoordinates);
  },
  updateCoordinates: function updateCoordinates(coordinates) {
    this.setState({
      coordinates: coordinates
    });
    return this.updateViewCoords(coordinates);
  },
  componentDidMount: function componentDidMount() {
    return this.componentDidUpdate();
  },
  componentDidUpdate: function componentDidUpdate() {
    return this.props.onUpdate(this.state.coordinates);
  },
  render: function render() {
    var a, button, div, i, input, label, li, ref, span;
    ref = React.DOM, div = ref.div, input = ref.input, a = ref.a, li = ref.li, label = ref.label, i = ref.i, span = ref.span;
    button = (function (_this) {
      return function (attr, zawartosc) {
        var newAttr;
        newAttr = Object.merge({
          href: "#!",
          className: 'btn btn-default'
        }, attr);
        return a(newAttr, zawartosc);
      };
    })(this);
    return div(null, div({
      className: 'well well-small'
    }, div({
      className: "input-group"
    }, input({
      className: "form-control",
      value: this.state.address,
      onChange: (function (_this) {
        return function (e) {
          return _this.setState({
            address: e.target.value
          });
        };
      })(this)
    }), span({
      className: "input-group-btn"
    }, button({
      ref: 'searchButton',
      className: "btn btn-default ladda-button",
      "data-style": "slide-right",
      onClick: (function (_this) {
        return function () {
          var searchButton;
          searchButton = $(_this.refs['searchButton'].getDOMNode());
          return _this.getResultsByAddress().always((function () {
            var ref1;
            return (ref1 = searchButton.data('ladda')) != null ? ref1.stop() : void 0;
          }).slowly(200));
        };
      })(this)
    }, span({
      className: "ladda-label"
    }, this.state.texts.szukaj)))), div(null, (function () {
      var ref1, ref2;
      switch (false) {
        case !((ref1 = this.state.searchResults) != null ? ref1.length : void 0):
        case this.state.searchResults !== null:
          return div({
            className: "list-group"
          }, (ref2 = this.state.searchResults) != null ? ref2.map((function (_this) {
            return function (result, index) {
              return a({
                key: index,
                className: "list-group-item",
                href: "#!",
                onClick: function onClick() {
                  return _this.updateCoordinates(result.coordinates);
                }
              }, result.displayName);
            };
          })(this)) : void 0);
        case !this.state.searchResults:
          return div({
            className: "alert alert-warning",
            role: "alert"
          }, this.state.texts.brakWynikowWyszukiwania);
      }
    }).call(this), div(null, button({
      onClick: (function (_this) {
        return function () {
          return _this.updateCoordinates(defaultCoordinates);
        };
      })(this)
    }, this.state.texts.wyczyscCoordynaty)), div({
      className: "list-group"
    }, Object.keys(this.state.coordinates).map((function (_this) {
      return function (name) {
        return li({
          className: "list-group-item",
          key: name
        }, label(null, mapowanieKoordynat[name]), div({
          className: "input-group"
        }, input({
          className: "form-control",
          value: _this.state.coordinates[name],
          onChange: function onChange(e) {
            if (e.target.value.match(/^\d+(\.)?(\d+)?$/)) {
              return _this.updateCoordinate(name, e.target.value);
            }
          }
        }), span({
          className: "input-group-btn"
        }, button({
          onClick: function onClick() {
            return _this.updateCoordinate(name, parseFloat(_this.state.coordinates[name]) - step);
          }
        }, i({
          className: "glyphicon glyphicon-minus"
        })), button({
          onClick: function onClick() {
            return _this.updateCoordinate(name, parseFloat(_this.state.coordinates[name]) + step);
          }
        }, i({
          className: "glyphicon glyphicon-plus"
        })))));
      };
    })(this))))), React.createElement(viewerComponent, {
      coordinates: this.state.viewCoordinates,
      size: this.props.size
    }));
  }
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImVkaXRvci5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7QUFDQSxPQUFPLENBQUMsa0JBQWtCLENBQUMsQ0FBQTtBQUMzQixJQUFJLEtBQUssR0FBRyxPQUFPLENBQUMsT0FBTyxDQUFDLENBQUE7QUFDNUIsSUFBSSxDQUFDLEdBQUcsT0FBTyxDQUFDLFFBQVEsQ0FBQyxDQUFBO0FBQ3pCLElBQUksZUFBZSxHQUFHLE9BQU8sQ0FBQyxVQUFVLENBQUMsQ0FBQyxPQUFPLENBQUE7O0FBRWpELElBQUksa0JBQWtCLEVBQUUsa0JBQWtCLEVBQUUsSUFBSSxDQUFDO0FBQ2pELElBQUksR0FBRyxLQUFLLENBQUM7QUFDYixrQkFBa0IsR0FBRztBQUNuQixJQUFFLEVBQUUscUJBQXFCO0FBQ3pCLElBQUUsRUFBRSxxQkFBcUI7QUFDekIsSUFBRSxFQUFFLHVCQUF1QjtBQUMzQixJQUFFLEVBQUUscUJBQXFCO0FBQ3pCLElBQUUsRUFBRSxxQkFBcUI7QUFDekIsSUFBRSxFQUFFLHNCQUFzQjtDQUMzQixDQUFDO0FBQ0Ysa0JBQWtCLEdBQUc7QUFDbkIsSUFBRSxFQUFFLEdBQUc7QUFDUCxJQUFFLEVBQUUsR0FBRztBQUNQLElBQUUsRUFBRSxHQUFHO0FBQ1AsSUFBRSxFQUFFLEdBQUc7QUFDUCxJQUFFLEVBQUUsR0FBRztBQUNQLElBQUUsRUFBRSxHQUFHO0NBQ1IsQ0FBQzs7a0JBRWEsS0FBSyxDQUFDLFdBQVcsQ0FBQztBQUMvQixhQUFXLEVBQUUscUJBQXFCO0FBQ2xDLGlCQUFlLEVBQUUsMkJBQVc7QUFDMUIsV0FBTztBQUNMLGlCQUFXLEVBQUUsa0JBQWtCO0FBQy9CLFVBQUksRUFBRTtBQUNKLGFBQUssRUFBRSxHQUFHO0FBQ1YsY0FBTSxFQUFFLEdBQUc7T0FDWjtBQUNELGFBQU8sRUFBRSxFQUFFO0tBQ1osQ0FBQztHQUNIO0FBQ0QsaUJBQWUsRUFBRSwyQkFBVztBQUMxQixXQUFPO0FBQ0wsYUFBTyxFQUFFLElBQUksQ0FBQyxLQUFLLENBQUMsT0FBTztBQUMzQixpQkFBVyxFQUFFLElBQUksQ0FBQyxLQUFLLENBQUMsV0FBVztBQUNuQyxtQkFBYSxFQUFFLElBQUk7QUFDbkIscUJBQWUsRUFBRSxJQUFJLENBQUMsS0FBSyxDQUFDLFdBQVc7QUFDdkMsV0FBSyxFQUFFO0FBQ0wsK0JBQXVCLEVBQUUsWUFBWTtBQUNyQywrQkFBdUIsRUFBRSxtQ0FBbUM7QUFDNUQseUJBQWlCLEVBQUUsbUJBQW1CO0FBQ3RDLGNBQU0sRUFBRSxRQUFRO09BQ2pCO0tBQ0YsQ0FBQztHQUNIO0FBQ0QscUJBQW1CLEVBQUUsK0JBQVc7QUFDOUIsV0FBTyxDQUFDLENBQUMsSUFBSSxDQUFDO0FBQ1osU0FBRyxFQUFFLGdEQUFnRDtBQUNyRCxjQUFRLEVBQUUsTUFBTTtBQUNoQixVQUFJLEVBQUU7QUFDSixTQUFDLEVBQUUsSUFBSSxDQUFDLEtBQUssQ0FBQyxPQUFPO0FBQ3JCLGNBQU0sRUFBRSxNQUFNO09BQ2Y7QUFDRCxhQUFPLEVBQUUsSUFBSTtBQUNiLGFBQU8sRUFBRSxDQUFDLFVBQVMsS0FBSyxFQUFFO0FBQ3hCLGVBQU8sVUFBUyxJQUFJLEVBQUU7QUFDcEIsY0FBSSxJQUFJLENBQUMsTUFBTSxFQUFFO0FBQ2YsbUJBQU8sS0FBSyxDQUFDLFFBQVEsQ0FBQztBQUNwQiwyQkFBYSxFQUFFLElBQUksQ0FBQyxHQUFHLENBQUMsVUFBUyxHQUFHLEVBQUU7QUFDcEMsdUJBQU87QUFDTCw2QkFBVyxFQUFFLEdBQUcsQ0FBQyxZQUFZO0FBQzdCLDZCQUFXLEVBQUU7QUFDWCxzQkFBRSxFQUFFLEdBQUcsQ0FBQyxXQUFXLENBQUMsQ0FBQyxDQUFDO0FBQ3RCLHNCQUFFLEVBQUUsR0FBRyxDQUFDLFdBQVcsQ0FBQyxDQUFDLENBQUM7QUFDdEIsc0JBQUUsRUFBRSxHQUFHLENBQUMsR0FBRztBQUNYLHNCQUFFLEVBQUUsR0FBRyxDQUFDLFdBQVcsQ0FBQyxDQUFDLENBQUM7QUFDdEIsc0JBQUUsRUFBRSxHQUFHLENBQUMsV0FBVyxDQUFDLENBQUMsQ0FBQztBQUN0QixzQkFBRSxFQUFFLEdBQUcsQ0FBQyxHQUFHO21CQUNaO2lCQUNGLENBQUM7ZUFDSCxDQUFDO2FBQ0gsQ0FBQyxDQUFDO1dBQ0osTUFBTTtBQUNMLGlCQUFLLENBQUMsUUFBUSxDQUFDO0FBQ2IsMkJBQWEsRUFBRSxFQUFFO2FBQ2xCLENBQUMsQ0FBQztBQUNILG1CQUFPLEtBQUssQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDLEtBQUssQ0FBQyx1QkFBdUIsQ0FBQyxDQUFDO1dBQ3pEO1NBQ0YsQ0FBQztPQUNILENBQUEsQ0FBRSxJQUFJLENBQUM7QUFDUixXQUFLLEVBQUUsQ0FBQyxVQUFTLEtBQUssRUFBRTtBQUN0QixlQUFPLFlBQVc7QUFDaEIsZUFBSyxDQUFDLFFBQVEsQ0FBQztBQUNiLHlCQUFhLEVBQUUsRUFBRTtXQUNsQixDQUFDLENBQUM7QUFDSCxpQkFBTyxLQUFLLENBQUMsS0FBSyxDQUFDLEtBQUssQ0FBQyxLQUFLLENBQUMsdUJBQXVCLENBQUMsQ0FBQztTQUN6RCxDQUFDO09BQ0gsQ0FBQSxDQUFFLElBQUksQ0FBQztLQUNULENBQUMsQ0FBQztHQUNKO0FBQ0Qsa0JBQWdCLEVBQUUsQ0FBQyxVQUFTLGNBQWMsRUFBRTtBQUMxQyxXQUFPLElBQUksQ0FBQyxRQUFRLENBQUM7QUFDbkIscUJBQWUsRUFBRSxjQUFjO0tBQ2hDLENBQUMsQ0FBQztHQUNKLENBQUEsQ0FBRSxNQUFNLENBQUMsR0FBRyxDQUFDO0FBQ2Qsa0JBQWdCLEVBQUUsMEJBQVMsSUFBSSxFQUFFLEtBQUssRUFBRTtBQUN0QyxRQUFJLFdBQVcsRUFBRSxjQUFjLENBQUM7QUFDaEMsZUFBVyxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsV0FBVyxDQUFDO0FBQ3JDLGtCQUFjLEdBQUcsTUFBTSxDQUFDLEtBQUssQ0FBQyxXQUFXLENBQUMsQ0FBQztBQUMzQyxrQkFBYyxDQUFDLElBQUksQ0FBQyxHQUFHLEtBQUssQ0FBQztBQUM3QixXQUFPLElBQUksQ0FBQyxpQkFBaUIsQ0FBQyxjQUFjLENBQUMsQ0FBQztHQUMvQztBQUNELG1CQUFpQixFQUFFLDJCQUFTLFdBQVcsRUFBRTtBQUN2QyxRQUFJLENBQUMsUUFBUSxDQUFDO0FBQ1osaUJBQVcsRUFBRSxXQUFXO0tBQ3pCLENBQUMsQ0FBQztBQUNILFdBQU8sSUFBSSxDQUFDLGdCQUFnQixDQUFDLFdBQVcsQ0FBQyxDQUFDO0dBQzNDO0FBQ0QsbUJBQWlCLEVBQUUsNkJBQVc7QUFDNUIsV0FBTyxJQUFJLENBQUMsa0JBQWtCLEVBQUUsQ0FBQztHQUNsQztBQUNELG9CQUFrQixFQUFFLDhCQUFXO0FBQzdCLFdBQU8sSUFBSSxDQUFDLEtBQUssQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxXQUFXLENBQUMsQ0FBQztHQUNwRDtBQUNELFFBQU0sRUFBRSxrQkFBVztBQUNqQixRQUFJLENBQUMsRUFBRSxNQUFNLEVBQUUsR0FBRyxFQUFFLENBQUMsRUFBRSxLQUFLLEVBQUUsS0FBSyxFQUFFLEVBQUUsRUFBRSxHQUFHLEVBQUUsSUFBSSxDQUFDO0FBQ25ELE9BQUcsR0FBRyxLQUFLLENBQUMsR0FBRyxFQUFFLEdBQUcsR0FBRyxHQUFHLENBQUMsR0FBRyxFQUFFLEtBQUssR0FBRyxHQUFHLENBQUMsS0FBSyxFQUFFLENBQUMsR0FBRyxHQUFHLENBQUMsQ0FBQyxFQUFFLEVBQUUsR0FBRyxHQUFHLENBQUMsRUFBRSxFQUFFLEtBQUssR0FBRyxHQUFHLENBQUMsS0FBSyxFQUFFLENBQUMsR0FBRyxHQUFHLENBQUMsQ0FBQyxFQUFFLElBQUksR0FBRyxHQUFHLENBQUMsSUFBSSxDQUFDO0FBQ3pILFVBQU0sR0FBRyxDQUFDLFVBQVMsS0FBSyxFQUFFO0FBQ3hCLGFBQU8sVUFBUyxJQUFJLEVBQUUsU0FBUyxFQUFFO0FBQy9CLFlBQUksT0FBTyxDQUFDO0FBQ1osZUFBTyxHQUFHLE1BQU0sQ0FBQyxLQUFLLENBQUM7QUFDckIsY0FBSSxFQUFFLElBQUk7QUFDVixtQkFBUyxFQUFFLGlCQUFpQjtTQUM3QixFQUFFLElBQUksQ0FBQyxDQUFDO0FBQ1QsZUFBTyxDQUFDLENBQUMsT0FBTyxFQUFFLFNBQVMsQ0FBQyxDQUFDO09BQzlCLENBQUM7S0FDSCxDQUFBLENBQUUsSUFBSSxDQUFDLENBQUM7QUFDVCxXQUFPLEdBQUcsQ0FBQyxJQUFJLEVBQUUsR0FBRyxDQUFDO0FBQ25CLGVBQVMsRUFBRSxpQkFBaUI7S0FDN0IsRUFBRSxHQUFHLENBQUM7QUFDTCxlQUFTLEVBQUUsYUFBYTtLQUN6QixFQUFFLEtBQUssQ0FBQztBQUNQLGVBQVMsRUFBRSxjQUFjO0FBQ3pCLFdBQUssRUFBRSxJQUFJLENBQUMsS0FBSyxDQUFDLE9BQU87QUFDekIsY0FBUSxFQUFFLENBQUMsVUFBUyxLQUFLLEVBQUU7QUFDekIsZUFBTyxVQUFTLENBQUMsRUFBRTtBQUNqQixpQkFBTyxLQUFLLENBQUMsUUFBUSxDQUFDO0FBQ3BCLG1CQUFPLEVBQUUsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxLQUFLO1dBQ3hCLENBQUMsQ0FBQztTQUNKLENBQUM7T0FDSCxDQUFBLENBQUUsSUFBSSxDQUFDO0tBQ1QsQ0FBQyxFQUFFLElBQUksQ0FBQztBQUNQLGVBQVMsRUFBRSxpQkFBaUI7S0FDN0IsRUFBRSxNQUFNLENBQUM7QUFDUixTQUFHLEVBQUUsY0FBYztBQUNuQixlQUFTLEVBQUUsOEJBQThCO0FBQ3pDLGtCQUFZLEVBQUUsYUFBYTtBQUMzQixhQUFPLEVBQUUsQ0FBQyxVQUFTLEtBQUssRUFBRTtBQUN4QixlQUFPLFlBQVc7QUFDaEIsY0FBSSxZQUFZLENBQUM7QUFDakIsc0JBQVksR0FBRyxDQUFDLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxjQUFjLENBQUMsQ0FBQyxVQUFVLEVBQUUsQ0FBQyxDQUFDO0FBQzFELGlCQUFPLEtBQUssQ0FBQyxtQkFBbUIsRUFBRSxDQUFDLE1BQU0sQ0FBQyxDQUFDLFlBQVc7QUFDcEQsZ0JBQUksSUFBSSxDQUFDO0FBQ1QsbUJBQU8sQ0FBQyxJQUFJLEdBQUcsWUFBWSxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsQ0FBQSxJQUFLLElBQUksR0FBRyxJQUFJLENBQUMsSUFBSSxFQUFFLEdBQUcsS0FBSyxDQUFDLENBQUM7V0FDM0UsQ0FBQSxDQUFFLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDO1NBQ2pCLENBQUM7T0FDSCxDQUFBLENBQUUsSUFBSSxDQUFDO0tBQ1QsRUFBRSxJQUFJLENBQUM7QUFDTixlQUFTLEVBQUUsYUFBYTtLQUN6QixFQUFFLElBQUksQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLEdBQUcsQ0FBQyxJQUFJLEVBQUUsQ0FBQyxZQUFXO0FBQ3BELFVBQUksSUFBSSxFQUFFLElBQUksQ0FBQztBQUNmLGNBQVEsS0FBSztBQUNYLGFBQUssRUFBRSxDQUFDLElBQUksR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLGFBQWEsQ0FBQSxJQUFLLElBQUksR0FBRyxJQUFJLENBQUMsTUFBTSxHQUFHLEtBQUssQ0FBQyxDQUFBLEFBQUMsQ0FBQztBQUN6RSxhQUFLLElBQUksQ0FBQyxLQUFLLENBQUMsYUFBYSxLQUFLLElBQUk7QUFDcEMsaUJBQU8sR0FBRyxDQUFDO0FBQ1QscUJBQVMsRUFBRSxZQUFZO1dBQ3hCLEVBQUUsQ0FBQyxJQUFJLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxhQUFhLENBQUEsSUFBSyxJQUFJLEdBQUcsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDLFVBQVMsS0FBSyxFQUFFO0FBQ3ZFLG1CQUFPLFVBQVMsTUFBTSxFQUFFLEtBQUssRUFBRTtBQUM3QixxQkFBTyxDQUFDLENBQUM7QUFDUCxtQkFBRyxFQUFFLEtBQUs7QUFDVix5QkFBUyxFQUFFLGlCQUFpQjtBQUM1QixvQkFBSSxFQUFFLElBQUk7QUFDVix1QkFBTyxFQUFFLG1CQUFXO0FBQ2xCLHlCQUFPLEtBQUssQ0FBQyxpQkFBaUIsQ0FBQyxNQUFNLENBQUMsV0FBVyxDQUFDLENBQUM7aUJBQ3BEO2VBQ0YsRUFBRSxNQUFNLENBQUMsV0FBVyxDQUFDLENBQUM7YUFDeEIsQ0FBQztXQUNILENBQUEsQ0FBRSxJQUFJLENBQUMsQ0FBQyxHQUFHLEtBQUssQ0FBQyxDQUFDLENBQUM7QUFBQSxBQUN0QixhQUFLLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxhQUFhO0FBQzVCLGlCQUFPLEdBQUcsQ0FBQztBQUNULHFCQUFTLEVBQUUscUJBQXFCO0FBQ2hDLGdCQUFJLEVBQUUsT0FBTztXQUNkLEVBQUUsSUFBSSxDQUFDLEtBQUssQ0FBQyxLQUFLLENBQUMsdUJBQXVCLENBQUMsQ0FBQztBQUFBLE9BQ2hEO0tBQ0YsQ0FBQSxDQUFFLElBQUksQ0FBQyxJQUFJLENBQUMsRUFBRSxHQUFHLENBQUMsSUFBSSxFQUFFLE1BQU0sQ0FBQztBQUM5QixhQUFPLEVBQUUsQ0FBQyxVQUFTLEtBQUssRUFBRTtBQUN4QixlQUFPLFlBQVc7QUFDaEIsaUJBQU8sS0FBSyxDQUFDLGlCQUFpQixDQUFDLGtCQUFrQixDQUFDLENBQUM7U0FDcEQsQ0FBQztPQUNILENBQUEsQ0FBRSxJQUFJLENBQUM7S0FDVCxFQUFFLElBQUksQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDLGlCQUFpQixDQUFDLENBQUMsRUFBRSxHQUFHLENBQUM7QUFDM0MsZUFBUyxFQUFFLFlBQVk7S0FDeEIsRUFBRSxNQUFNLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsV0FBVyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsVUFBUyxLQUFLLEVBQUU7QUFDMUQsYUFBTyxVQUFTLElBQUksRUFBRTtBQUNwQixlQUFPLEVBQUUsQ0FBQztBQUNSLG1CQUFTLEVBQUUsaUJBQWlCO0FBQzVCLGFBQUcsRUFBRSxJQUFJO1NBQ1YsRUFBRSxLQUFLLENBQUMsSUFBSSxFQUFFLGtCQUFrQixDQUFDLElBQUksQ0FBQyxDQUFDLEVBQUUsR0FBRyxDQUFDO0FBQzVDLG1CQUFTLEVBQUUsYUFBYTtTQUN6QixFQUFFLEtBQUssQ0FBQztBQUNQLG1CQUFTLEVBQUUsY0FBYztBQUN6QixlQUFLLEVBQUUsS0FBSyxDQUFDLEtBQUssQ0FBQyxXQUFXLENBQUMsSUFBSSxDQUFDO0FBQ3BDLGtCQUFRLEVBQUUsa0JBQVMsQ0FBQyxFQUFFO0FBQ3BCLGdCQUFJLENBQUMsQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLEtBQUssQ0FBQyxrQkFBa0IsQ0FBQyxFQUFFO0FBQzVDLHFCQUFPLEtBQUssQ0FBQyxnQkFBZ0IsQ0FBQyxJQUFJLEVBQUUsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsQ0FBQzthQUNyRDtXQUNGO1NBQ0YsQ0FBQyxFQUFFLElBQUksQ0FBQztBQUNQLG1CQUFTLEVBQUUsaUJBQWlCO1NBQzdCLEVBQUUsTUFBTSxDQUFDO0FBQ1IsaUJBQU8sRUFBRSxtQkFBVztBQUNsQixtQkFBTyxLQUFLLENBQUMsZ0JBQWdCLENBQUMsSUFBSSxFQUFFLFVBQVUsQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDLFdBQVcsQ0FBQyxJQUFJLENBQUMsQ0FBQyxHQUFHLElBQUksQ0FBQyxDQUFDO1dBQ3ZGO1NBQ0YsRUFBRSxDQUFDLENBQUM7QUFDSCxtQkFBUyxFQUFFLDJCQUEyQjtTQUN2QyxDQUFDLENBQUMsRUFBRSxNQUFNLENBQUM7QUFDVixpQkFBTyxFQUFFLG1CQUFXO0FBQ2xCLG1CQUFPLEtBQUssQ0FBQyxnQkFBZ0IsQ0FBQyxJQUFJLEVBQUUsVUFBVSxDQUFDLEtBQUssQ0FBQyxLQUFLLENBQUMsV0FBVyxDQUFDLElBQUksQ0FBQyxDQUFDLEdBQUcsSUFBSSxDQUFDLENBQUM7V0FDdkY7U0FDRixFQUFFLENBQUMsQ0FBQztBQUNILG1CQUFTLEVBQUUsMEJBQTBCO1NBQ3RDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO09BQ1IsQ0FBQztLQUNILENBQUEsQ0FBRSxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLEtBQUssQ0FBQyxhQUFhLENBQUMsZUFBZSxFQUFFO0FBQ2pELGlCQUFXLEVBQUUsSUFBSSxDQUFDLEtBQUssQ0FBQyxlQUFlO0FBQ3ZDLFVBQUksRUFBRSxJQUFJLENBQUMsS0FBSyxDQUFDLElBQUk7S0FDdEIsQ0FBQyxDQUFDLENBQUM7R0FDTDtDQUNGLENBQUMiLCJmaWxlIjoianMvY29tcG9uZW50cy9lZGl0b3IuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvLyBHZW5lcmF0ZWQgYnkgQ29mZmVlU2NyaXB0IDEuMTAuMFxucmVxdWlyZSgnLi4vY29tbW9uL2NvbW1vbicpXG52YXIgUmVhY3QgPSByZXF1aXJlKCdyZWFjdCcpXG52YXIgJCA9IHJlcXVpcmUoJ2pxdWVyeScpXG52YXIgdmlld2VyQ29tcG9uZW50ID0gcmVxdWlyZSgnLi92aWV3ZXInKS5kZWZhdWx0XG5cbnZhciBkZWZhdWx0Q29vcmRpbmF0ZXMsIG1hcG93YW5pZUtvb3JkeW5hdCwgc3RlcDtcbnN0ZXAgPSAwLjAwMjtcbm1hcG93YW5pZUtvb3JkeW5hdCA9IHtcbiAgeDE6ICdYMSAtIGxvbmdpdHVkZSB3ZXN0JyxcbiAgeDI6ICdYMiAtIGxvbmdpdHVkZSBlYXN0JyxcbiAgeDM6ICdYMyAtIGxvbmdpdHVkZSBtYXJrZXInLFxuICB5MTogJ1kxIC0gbGF0aXR1ZGUgc291dGgnLFxuICB5MjogJ1kyIC0gbGF0aXR1ZGUgbm9ydGgnLFxuICB5MzogJ1kzIC0gbGF0aXR1ZGUgbWFya2VyJ1xufTtcbmRlZmF1bHRDb29yZGluYXRlcyA9IHtcbiAgeDE6IDAuMCxcbiAgeDI6IDAuMCxcbiAgeDM6IDAuMCxcbiAgeTE6IDAuMCxcbiAgeTI6IDAuMCxcbiAgeTM6IDAuMFxufTtcblxuZXhwb3J0IGRlZmF1bHQgUmVhY3QuY3JlYXRlQ2xhc3Moe1xuICBkaXNwbGF5TmFtZTogJ29wZW5TdHJlZXRNYXBFZGl0b3InLFxuICBnZXREZWZhdWx0UHJvcHM6IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiB7XG4gICAgICBjb29yZGluYXRlczogZGVmYXVsdENvb3JkaW5hdGVzLFxuICAgICAgc2l6ZToge1xuICAgICAgICB3aWR0aDogNDI1LFxuICAgICAgICBoZWlnaHQ6IDM1MFxuICAgICAgfSxcbiAgICAgIGFkZHJlc3M6ICcnXG4gICAgfTtcbiAgfSxcbiAgZ2V0SW5pdGlhbFN0YXRlOiBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4ge1xuICAgICAgYWRkcmVzczogdGhpcy5wcm9wcy5hZGRyZXNzLFxuICAgICAgY29vcmRpbmF0ZXM6IHRoaXMucHJvcHMuY29vcmRpbmF0ZXMsXG4gICAgICBzZWFyY2hSZXN1bHRzOiBudWxsLFxuICAgICAgdmlld0Nvb3JkaW5hdGVzOiB0aGlzLnByb3BzLmNvb3JkaW5hdGVzLFxuICAgICAgdGV4dHM6IHtcbiAgICAgICAgYnJha1d5bmlrb3dXeXN6dWtpd2FuaWE6IFwiTm8gcmVzdWx0c1wiLFxuICAgICAgICBibGFkT2Rwb3dpZWR6aU5vbWluYXRpbTogXCJObyByZXNwb25zZSBmcm9tIE5vbWluYXRpbSBzZXJ2ZXJcIixcbiAgICAgICAgd3ljenlzY0Nvb3JkeW5hdHk6IFwiQ2xlYXIgY29vcmRpbmF0ZXNcIixcbiAgICAgICAgc3p1a2FqOiBcIlNlYXJjaFwiXG4gICAgICB9XG4gICAgfTtcbiAgfSxcbiAgZ2V0UmVzdWx0c0J5QWRkcmVzczogZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuICQuYWpheCh7XG4gICAgICB1cmw6ICdodHRwczovL25vbWluYXRpbS5vcGVuc3RyZWV0bWFwLm9yZy9zZWFyY2gucGhwJyxcbiAgICAgIGRhdGFUeXBlOiAnanNvbicsXG4gICAgICBkYXRhOiB7XG4gICAgICAgIHE6IHRoaXMuc3RhdGUuYWRkcmVzcyxcbiAgICAgICAgZm9ybWF0OiAnanNvbidcbiAgICAgIH0sXG4gICAgICB0aW1lb3V0OiA1MDAwLFxuICAgICAgc3VjY2VzczogKGZ1bmN0aW9uKF90aGlzKSB7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgaWYgKGRhdGEubGVuZ3RoKSB7XG4gICAgICAgICAgICByZXR1cm4gX3RoaXMuc2V0U3RhdGUoe1xuICAgICAgICAgICAgICBzZWFyY2hSZXN1bHRzOiBkYXRhLm1hcChmdW5jdGlvbihvYmopIHtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgZGlzcGxheU5hbWU6IG9iai5kaXNwbGF5X25hbWUsXG4gICAgICAgICAgICAgICAgICBjb29yZGluYXRlczoge1xuICAgICAgICAgICAgICAgICAgICB4MTogb2JqLmJvdW5kaW5nYm94WzJdLFxuICAgICAgICAgICAgICAgICAgICB4Mjogb2JqLmJvdW5kaW5nYm94WzNdLFxuICAgICAgICAgICAgICAgICAgICB4Mzogb2JqLmxvbixcbiAgICAgICAgICAgICAgICAgICAgeTE6IG9iai5ib3VuZGluZ2JveFswXSxcbiAgICAgICAgICAgICAgICAgICAgeTI6IG9iai5ib3VuZGluZ2JveFsxXSxcbiAgICAgICAgICAgICAgICAgICAgeTM6IG9iai5sYXRcbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIF90aGlzLnNldFN0YXRlKHtcbiAgICAgICAgICAgICAgc2VhcmNoUmVzdWx0czogW11cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIGFsZXJ0KF90aGlzLnN0YXRlLnRleHRzLmJyYWtXeW5pa293V3lzenVraXdhbmlhKTtcbiAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICB9KSh0aGlzKSxcbiAgICAgIGVycm9yOiAoZnVuY3Rpb24oX3RoaXMpIHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKCkge1xuICAgICAgICAgIF90aGlzLnNldFN0YXRlKHtcbiAgICAgICAgICAgIHNlYXJjaFJlc3VsdHM6IFtdXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgcmV0dXJuIGFsZXJ0KF90aGlzLnN0YXRlLnRleHRzLmJsYWRPZHBvd2llZHppTm9taW5hdGltKTtcbiAgICAgICAgfTtcbiAgICAgIH0pKHRoaXMpXG4gICAgfSk7XG4gIH0sXG4gIHVwZGF0ZVZpZXdDb29yZHM6IChmdW5jdGlvbihuZXdDb29yZGluYXRlcykge1xuICAgIHJldHVybiB0aGlzLnNldFN0YXRlKHtcbiAgICAgIHZpZXdDb29yZGluYXRlczogbmV3Q29vcmRpbmF0ZXNcbiAgICB9KTtcbiAgfSkuc2xvd2x5KDUwMCksXG4gIHVwZGF0ZUNvb3JkaW5hdGU6IGZ1bmN0aW9uKG5hbWUsIHZhbHVlKSB7XG4gICAgdmFyIGNvb3JkaW5hdGVzLCBuZXdDb29yZGluYXRlcztcbiAgICBjb29yZGluYXRlcyA9IHRoaXMuc3RhdGUuY29vcmRpbmF0ZXM7XG4gICAgbmV3Q29vcmRpbmF0ZXMgPSBPYmplY3QuY2xvbmUoY29vcmRpbmF0ZXMpO1xuICAgIG5ld0Nvb3JkaW5hdGVzW25hbWVdID0gdmFsdWU7XG4gICAgcmV0dXJuIHRoaXMudXBkYXRlQ29vcmRpbmF0ZXMobmV3Q29vcmRpbmF0ZXMpO1xuICB9LFxuICB1cGRhdGVDb29yZGluYXRlczogZnVuY3Rpb24oY29vcmRpbmF0ZXMpIHtcbiAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgIGNvb3JkaW5hdGVzOiBjb29yZGluYXRlc1xuICAgIH0pO1xuICAgIHJldHVybiB0aGlzLnVwZGF0ZVZpZXdDb29yZHMoY29vcmRpbmF0ZXMpO1xuICB9LFxuICBjb21wb25lbnREaWRNb3VudDogZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIHRoaXMuY29tcG9uZW50RGlkVXBkYXRlKCk7XG4gIH0sXG4gIGNvbXBvbmVudERpZFVwZGF0ZTogZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIHRoaXMucHJvcHMub25VcGRhdGUodGhpcy5zdGF0ZS5jb29yZGluYXRlcyk7XG4gIH0sXG4gIHJlbmRlcjogZnVuY3Rpb24oKSB7XG4gICAgdmFyIGEsIGJ1dHRvbiwgZGl2LCBpLCBpbnB1dCwgbGFiZWwsIGxpLCByZWYsIHNwYW47XG4gICAgcmVmID0gUmVhY3QuRE9NLCBkaXYgPSByZWYuZGl2LCBpbnB1dCA9IHJlZi5pbnB1dCwgYSA9IHJlZi5hLCBsaSA9IHJlZi5saSwgbGFiZWwgPSByZWYubGFiZWwsIGkgPSByZWYuaSwgc3BhbiA9IHJlZi5zcGFuO1xuICAgIGJ1dHRvbiA9IChmdW5jdGlvbihfdGhpcykge1xuICAgICAgcmV0dXJuIGZ1bmN0aW9uKGF0dHIsIHphd2FydG9zYykge1xuICAgICAgICB2YXIgbmV3QXR0cjtcbiAgICAgICAgbmV3QXR0ciA9IE9iamVjdC5tZXJnZSh7XG4gICAgICAgICAgaHJlZjogXCIjIVwiLFxuICAgICAgICAgIGNsYXNzTmFtZTogJ2J0biBidG4tZGVmYXVsdCdcbiAgICAgICAgfSwgYXR0cik7XG4gICAgICAgIHJldHVybiBhKG5ld0F0dHIsIHphd2FydG9zYyk7XG4gICAgICB9O1xuICAgIH0pKHRoaXMpO1xuICAgIHJldHVybiBkaXYobnVsbCwgZGl2KHtcbiAgICAgIGNsYXNzTmFtZTogJ3dlbGwgd2VsbC1zbWFsbCdcbiAgICB9LCBkaXYoe1xuICAgICAgY2xhc3NOYW1lOiBcImlucHV0LWdyb3VwXCJcbiAgICB9LCBpbnB1dCh7XG4gICAgICBjbGFzc05hbWU6IFwiZm9ybS1jb250cm9sXCIsXG4gICAgICB2YWx1ZTogdGhpcy5zdGF0ZS5hZGRyZXNzLFxuICAgICAgb25DaGFuZ2U6IChmdW5jdGlvbihfdGhpcykge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24oZSkge1xuICAgICAgICAgIHJldHVybiBfdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgICAgICBhZGRyZXNzOiBlLnRhcmdldC52YWx1ZVxuICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuICAgICAgfSkodGhpcylcbiAgICB9KSwgc3Bhbih7XG4gICAgICBjbGFzc05hbWU6IFwiaW5wdXQtZ3JvdXAtYnRuXCJcbiAgICB9LCBidXR0b24oe1xuICAgICAgcmVmOiAnc2VhcmNoQnV0dG9uJyxcbiAgICAgIGNsYXNzTmFtZTogXCJidG4gYnRuLWRlZmF1bHQgbGFkZGEtYnV0dG9uXCIsXG4gICAgICBcImRhdGEtc3R5bGVcIjogXCJzbGlkZS1yaWdodFwiLFxuICAgICAgb25DbGljazogKGZ1bmN0aW9uKF90aGlzKSB7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbigpIHtcbiAgICAgICAgICB2YXIgc2VhcmNoQnV0dG9uO1xuICAgICAgICAgIHNlYXJjaEJ1dHRvbiA9ICQoX3RoaXMucmVmc1snc2VhcmNoQnV0dG9uJ10uZ2V0RE9NTm9kZSgpKTtcbiAgICAgICAgICByZXR1cm4gX3RoaXMuZ2V0UmVzdWx0c0J5QWRkcmVzcygpLmFsd2F5cygoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB2YXIgcmVmMTtcbiAgICAgICAgICAgIHJldHVybiAocmVmMSA9IHNlYXJjaEJ1dHRvbi5kYXRhKCdsYWRkYScpKSAhPSBudWxsID8gcmVmMS5zdG9wKCkgOiB2b2lkIDA7XG4gICAgICAgICAgfSkuc2xvd2x5KDIwMCkpO1xuICAgICAgICB9O1xuICAgICAgfSkodGhpcylcbiAgICB9LCBzcGFuKHtcbiAgICAgIGNsYXNzTmFtZTogXCJsYWRkYS1sYWJlbFwiXG4gICAgfSwgdGhpcy5zdGF0ZS50ZXh0cy5zenVrYWopKSkpLCBkaXYobnVsbCwgKGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIHJlZjEsIHJlZjI7XG4gICAgICBzd2l0Y2ggKGZhbHNlKSB7XG4gICAgICAgIGNhc2UgISgocmVmMSA9IHRoaXMuc3RhdGUuc2VhcmNoUmVzdWx0cykgIT0gbnVsbCA/IHJlZjEubGVuZ3RoIDogdm9pZCAwKTpcbiAgICAgICAgY2FzZSB0aGlzLnN0YXRlLnNlYXJjaFJlc3VsdHMgIT09IG51bGw6XG4gICAgICAgICAgcmV0dXJuIGRpdih7XG4gICAgICAgICAgICBjbGFzc05hbWU6IFwibGlzdC1ncm91cFwiXG4gICAgICAgICAgfSwgKHJlZjIgPSB0aGlzLnN0YXRlLnNlYXJjaFJlc3VsdHMpICE9IG51bGwgPyByZWYyLm1hcCgoZnVuY3Rpb24oX3RoaXMpIHtcbiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbihyZXN1bHQsIGluZGV4KSB7XG4gICAgICAgICAgICAgIHJldHVybiBhKHtcbiAgICAgICAgICAgICAgICBrZXk6IGluZGV4LFxuICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogXCJsaXN0LWdyb3VwLWl0ZW1cIixcbiAgICAgICAgICAgICAgICBocmVmOiBcIiMhXCIsXG4gICAgICAgICAgICAgICAgb25DbGljazogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMudXBkYXRlQ29vcmRpbmF0ZXMocmVzdWx0LmNvb3JkaW5hdGVzKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH0sIHJlc3VsdC5kaXNwbGF5TmFtZSk7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgIH0pKHRoaXMpKSA6IHZvaWQgMCk7XG4gICAgICAgIGNhc2UgIXRoaXMuc3RhdGUuc2VhcmNoUmVzdWx0czpcbiAgICAgICAgICByZXR1cm4gZGl2KHtcbiAgICAgICAgICAgIGNsYXNzTmFtZTogXCJhbGVydCBhbGVydC13YXJuaW5nXCIsXG4gICAgICAgICAgICByb2xlOiBcImFsZXJ0XCJcbiAgICAgICAgICB9LCB0aGlzLnN0YXRlLnRleHRzLmJyYWtXeW5pa293V3lzenVraXdhbmlhKTtcbiAgICAgIH1cbiAgICB9KS5jYWxsKHRoaXMpLCBkaXYobnVsbCwgYnV0dG9uKHtcbiAgICAgIG9uQ2xpY2s6IChmdW5jdGlvbihfdGhpcykge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcmV0dXJuIF90aGlzLnVwZGF0ZUNvb3JkaW5hdGVzKGRlZmF1bHRDb29yZGluYXRlcyk7XG4gICAgICAgIH07XG4gICAgICB9KSh0aGlzKVxuICAgIH0sIHRoaXMuc3RhdGUudGV4dHMud3ljenlzY0Nvb3JkeW5hdHkpKSwgZGl2KHtcbiAgICAgIGNsYXNzTmFtZTogXCJsaXN0LWdyb3VwXCJcbiAgICB9LCBPYmplY3Qua2V5cyh0aGlzLnN0YXRlLmNvb3JkaW5hdGVzKS5tYXAoKGZ1bmN0aW9uKF90aGlzKSB7XG4gICAgICByZXR1cm4gZnVuY3Rpb24obmFtZSkge1xuICAgICAgICByZXR1cm4gbGkoe1xuICAgICAgICAgIGNsYXNzTmFtZTogXCJsaXN0LWdyb3VwLWl0ZW1cIixcbiAgICAgICAgICBrZXk6IG5hbWVcbiAgICAgICAgfSwgbGFiZWwobnVsbCwgbWFwb3dhbmllS29vcmR5bmF0W25hbWVdKSwgZGl2KHtcbiAgICAgICAgICBjbGFzc05hbWU6IFwiaW5wdXQtZ3JvdXBcIlxuICAgICAgICB9LCBpbnB1dCh7XG4gICAgICAgICAgY2xhc3NOYW1lOiBcImZvcm0tY29udHJvbFwiLFxuICAgICAgICAgIHZhbHVlOiBfdGhpcy5zdGF0ZS5jb29yZGluYXRlc1tuYW1lXSxcbiAgICAgICAgICBvbkNoYW5nZTogZnVuY3Rpb24oZSkge1xuICAgICAgICAgICAgaWYgKGUudGFyZ2V0LnZhbHVlLm1hdGNoKC9eXFxkKyhcXC4pPyhcXGQrKT8kLykpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIF90aGlzLnVwZGF0ZUNvb3JkaW5hdGUobmFtZSwgZS50YXJnZXQudmFsdWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSksIHNwYW4oe1xuICAgICAgICAgIGNsYXNzTmFtZTogXCJpbnB1dC1ncm91cC1idG5cIlxuICAgICAgICB9LCBidXR0b24oe1xuICAgICAgICAgIG9uQ2xpY2s6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcmV0dXJuIF90aGlzLnVwZGF0ZUNvb3JkaW5hdGUobmFtZSwgcGFyc2VGbG9hdChfdGhpcy5zdGF0ZS5jb29yZGluYXRlc1tuYW1lXSkgLSBzdGVwKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0sIGkoe1xuICAgICAgICAgIGNsYXNzTmFtZTogXCJnbHlwaGljb24gZ2x5cGhpY29uLW1pbnVzXCJcbiAgICAgICAgfSkpLCBidXR0b24oe1xuICAgICAgICAgIG9uQ2xpY2s6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcmV0dXJuIF90aGlzLnVwZGF0ZUNvb3JkaW5hdGUobmFtZSwgcGFyc2VGbG9hdChfdGhpcy5zdGF0ZS5jb29yZGluYXRlc1tuYW1lXSkgKyBzdGVwKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0sIGkoe1xuICAgICAgICAgIGNsYXNzTmFtZTogXCJnbHlwaGljb24gZ2x5cGhpY29uLXBsdXNcIlxuICAgICAgICB9KSkpKSk7XG4gICAgICB9O1xuICAgIH0pKHRoaXMpKSkpKSwgUmVhY3QuY3JlYXRlRWxlbWVudCh2aWV3ZXJDb21wb25lbnQsIHtcbiAgICAgIGNvb3JkaW5hdGVzOiB0aGlzLnN0YXRlLnZpZXdDb29yZGluYXRlcyxcbiAgICAgIHNpemU6IHRoaXMucHJvcHMuc2l6ZVxuICAgIH0pKTtcbiAgfVxufSlcbiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
